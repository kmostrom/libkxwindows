///////////////////////////////////////////////////////////////////////////////////////////////////////////

#include <kxWindows/UIEdit.h>

#include <windows.h>

///////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::CharFromPos(long x, long y)
{
	return ::SendMessage(mWindowHandle, EM_CHARFROMPOS, (WPARAM) 0, (LPARAM) MAKELPARAM(x, y));
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::EmptyUndoBuffer(void)
{
	return ::SendMessage(mWindowHandle, EM_EMPTYUNDOBUFFER, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::FmtLines(BOOL addEol)
{
	return ::SendMessage(mWindowHandle, EM_FMTLINES, (WPARAM) addEol, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetFirstVisibleLine(void)
{
	return ::SendMessage(mWindowHandle, EM_GETFIRSTVISIBLELINE, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetHandle(void)
{
	return ::SendMessage(mWindowHandle, EM_GETHANDLE, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetLimitText(void)
{
	return ::SendMessage(mWindowHandle, EM_GETLIMITTEXT, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetLine(long lineNumber, LPCSTR string)
{
	return ::SendMessage(mWindowHandle, EM_GETLINE, (WPARAM) lineNumber, (LPARAM) string);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetLineCount(void)
{
	return ::SendMessage(mWindowHandle, EM_GETLINECOUNT, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetMargins(void)
{
	return ::SendMessage(mWindowHandle, EM_GETMARGINS, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetModify(void)
{
	return ::SendMessage(mWindowHandle, EM_GETMODIFY, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetPasswordChar(void)
{
	return ::SendMessage(mWindowHandle, EM_GETPASSWORDCHAR, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetRect(LPRECT rect)
{
	return ::SendMessage(mWindowHandle, EM_GETRECT, (WPARAM) 0, (LPARAM) rect);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetSel(LPDWORD start, LPDWORD end)
{
	return ::SendMessage(mWindowHandle, EM_GETSEL, (WPARAM) start, (LPARAM) end);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetThumb(void)
{
	return ::SendMessage(mWindowHandle, EM_GETTHUMB, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::GetWordBreakProc(void)
{
	return ::SendMessage(mWindowHandle, EM_GETWORDBREAKPROC, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::LimitText(int characterCount)
{
	return ::SendMessage(mWindowHandle, EM_LIMITTEXT, (WPARAM) characterCount, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::LineFromChar(int index)
{
	return ::SendMessage(mWindowHandle, EM_LINEFROMCHAR, (WPARAM) index, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::LineIndex(int line)
{
	return ::SendMessage(mWindowHandle, EM_LINEINDEX, (WPARAM) line, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::LineLength(int line)
{
	return ::SendMessage(mWindowHandle, EM_LINELENGTH, (WPARAM) line, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::LineScroll(int lines, int numCharacters)
{
	return ::SendMessage(mWindowHandle, EM_LINESCROLL, (WPARAM) numCharacters, (LPARAM) lines);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::PosFromChar(UINT numCharacters)
{
	return ::SendMessage(mWindowHandle, EM_POSFROMCHAR, (WPARAM) numCharacters, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::ReplaceSel(LPCTSTR newText, BOOL canUndo)
{
	return ::SendMessage(mWindowHandle, EM_REPLACESEL, (WPARAM) canUndo, (LPARAM) newText);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::Scroll(int action)
{
	return ::SendMessage(mWindowHandle, EM_SCROLL, (WPARAM) action, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::ScrollCaret(void)
{
	return ::SendMessage(mWindowHandle, EM_SCROLLCARET, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetHandle(HLOCAL buffer)
{
	return ::SendMessage(mWindowHandle, EM_SETHANDLE, (WPARAM) buffer, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetLimitText(UINT maxLimit)
{
	return ::SendMessage(mWindowHandle, EM_SETLIMITTEXT, (WPARAM) maxLimit, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetMargins(long marginOptions, long newMargin, int useFontInfo)
{
	if(useFontInfo == USE_FONTINFO_LEFT)
		return ::SendMessage(mWindowHandle, EM_SETMARGINS, (WPARAM) marginOptions, MAKELPARAM(EC_USEFONTINFO, 0));

	if(useFontInfo == USE_FONTINFO_RIGHT)
		return ::SendMessage(mWindowHandle, EM_SETMARGINS, (WPARAM) marginOptions, MAKELPARAM(0, EC_USEFONTINFO));

	if(useFontInfo == USE_FONTINFO_NONE)
		return ::SendMessage(mWindowHandle, EM_SETMARGINS, (WPARAM) marginOptions, MAKELPARAM(newMargin, 0));

	return ::SendMessage(mWindowHandle, EM_SETMARGINS, (WPARAM) marginOptions, MAKELPARAM(EC_USEFONTINFO, 0));
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetModify(BOOL isModified)
{
	return ::SendMessage(mWindowHandle, EM_SETMODIFY, (WPARAM) isModified, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetPasswordChar(TCHAR passwordCharacter)
{
	return ::SendMessage(mWindowHandle, EM_SETPASSWORDCHAR, (WPARAM) passwordCharacter, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetReadOnly(BOOL isReadOnly)
{
	return ::SendMessage(mWindowHandle, EM_SETREADONLY, (WPARAM) isReadOnly, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetRect(LPRECT rect)
{
	return ::SendMessage(mWindowHandle, EM_SETRECT, (WPARAM) 0, (LPARAM) rect);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetRectNP(LPRECT rect)
{
	return ::SendMessage(mWindowHandle, EM_SETRECTNP, (WPARAM) 0, (LPARAM) rect);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetSel(int startPosition, int endPosition)
{
	return ::SendMessage(mWindowHandle, EM_SETSEL, (WPARAM) startPosition, (LPARAM) endPosition);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetTabStops(int numTabStops, LPINT tabStops)
{
	return ::SendMessage(mWindowHandle, EM_SETTABSTOPS, (WPARAM) numTabStops, (LPARAM) tabStops);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::SetWordBreakProc(WNDPROC *wndProc)
{
	return ::SendMessage(mWindowHandle, EM_SETWORDBREAKPROC, (WPARAM) 0, (LPARAM) wndProc);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIEdit::Undo(void)
{
	return ::SendMessage(mWindowHandle, EM_UNDO, (WPARAM) 0, (LPARAM) 0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////////

#include <kxWindows/UIButton.h>
#include <kxWindows/Rect.h>

///////////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::Click(void)
{
	return(::SendMessage(mWindowHandle, BM_CLICK, (WPARAM)0, (LPARAM)0));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::GetCheck(void)
{
	return(::SendMessage(mWindowHandle, BM_GETCHECK, (WPARAM)0, (LPARAM)0));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::GetImage(int iImageType)
{
	return(::SendMessage(mWindowHandle, BM_GETIMAGE, (WPARAM)iImageType, (LPARAM)0));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::GetState(void)
{
	return(::SendMessage(mWindowHandle, BM_GETSTATE, (WPARAM)0, (LPARAM)0));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::SetCheck(int iCheckState)
{
	return(::SendMessage(mWindowHandle, BM_SETCHECK, (WPARAM)iCheckState, (LPARAM)0));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::SetImage(int iImageType, HANDLE hImage)
{
	return(::SendMessage(mWindowHandle, BM_SETIMAGE, (WPARAM)iImageType, (LPARAM)hImage));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::SetState(BOOL bHighlight)
{
	return(::SendMessage(mWindowHandle, BM_SETSTATE, (WPARAM)bHighlight, (LPARAM)0));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::SetStyle(DWORD dwStyles, BOOL bRedraw)
{
	return(::SendMessage(mWindowHandle, BM_SETSTYLE, (WPARAM)dwStyles, (LPARAM)bRedraw));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::GetIdealSize(LPSIZE pSize)
{
	return(::SendMessage(mWindowHandle, BCM_GETIDEALSIZE, (WPARAM)0, (LPARAM)pSize));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::GetImageList(PBUTTON_IMAGELIST pImageList)
{
	return(::SendMessage(mWindowHandle, BCM_GETIMAGELIST, (WPARAM)0, (LPARAM)pImageList));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::GetTextMargin(LPRECT pRect)
{
	return(::SendMessage(mWindowHandle, BCM_GETTEXTMARGIN, (WPARAM)0, (LPARAM)pRect));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::SetImageList(PBUTTON_IMAGELIST pImageList)
{
	return(::SendMessage(mWindowHandle, BCM_SETIMAGELIST, (WPARAM)0, (LPARAM)pImageList));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////

LRESULT UIButton::SetTextMargin(LPRECT pRect)
{
	return(::SendMessage(mWindowHandle, BCM_SETTEXTMARGIN, (WPARAM)0, (LPARAM)pRect));
}

///////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////

// Extended Function Set

///////////////////////////////////////////////////////////////////////////////////////////////////////
/*
LRESULT UIButton::SetBitmapFromFile(LPCTSTR pszBitmap)
{
	HANDLE hBitmap = LoadImage(0, pszBitmap, IMAGE_BITMAP, NULL, NULL, LR_LOADFROMFILE | LR_VGACOLOR);
	return(SetImage(IMAGE_BITMAP, hBitmap));
}
*/
/*
LRESULT UIButton::SetIconFromFile(LPCTSTR pszIcon)
{
	HANDLE hIcon = LoadImage(0, pszIcon, IMAGE_ICON, NULL, NULL, LR_LOADFROMFILE | LR_VGACOLOR);
	return(SetImage(IMAGE_ICON, hIcon));
}
*/

void UIButton::Create(const char* buttonText, HWND parentWindowHandle, UINT id)
{
	mWindowHandle = CreateWindowEx(
		0,
		"button",
		buttonText,
		WS_VISIBLE | WS_CHILD | BS_PUSHBUTTON,
		0, 0, 120, 27,
		parentWindowHandle,
		(HMENU) id,
		GetModuleHandle(NULL),
		NULL);

	PostMessage(mWindowHandle, WM_SETFONT, (WPARAM) GetStockObject(ANSI_VAR_FONT), FALSE);
}
